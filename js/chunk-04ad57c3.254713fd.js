(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-04ad57c3"],{"2ebe":function(t,e,n){"use strict";n("82aa")},3213:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.articleDetails?n("div",{staticClass:"topic"},[n("div",{staticClass:"article"},[n("div",{staticClass:"title"},[t.articleDetails.good?n("span",{staticClass:"good"},[t._v("精华")]):t._e(),t.articleDetails.top?n("span",{staticClass:"top"},[t._v("置顶")]):t._e(),n("h2",[t._v(t._s(t.articleDetails.title))])]),n("div",{staticClass:"details"},[n("ul",[n("li",[t._v("发布于"+t._s(t._f("fromatDataFromNow")(t.articleDetails.create_at)))]),n("li",[t._v("作者"+t._s(t.author.loginname))]),n("li",[t._v("浏览量"+t._s(t.articleDetails.visit_count))])]),t.articleDetails.is_collect?n("el-button",{staticClass:"collect",attrs:{size:"mini",type:"info"},on:{click:function(e){return t.changecollect(t.articleDetails.id)}}},[t._v("取消收藏")]):n("el-button",{staticClass:"collect",attrs:{size:"mini",type:"success"},on:{click:function(e){return t.changecollect(t.articleDetails.id)}}},[t._v("收藏")])],1),n("hr"),n("div",{staticClass:"content",domProps:{innerHTML:t._s(t.articleDetails.content)}}),n("div",{staticClass:"reply"},[n("panel",{scopedSlots:t._u([{key:"header",fn:function(){return[n("h2",{staticStyle:{"padding-left":"20px"}},[t._v("评论")])]},proxy:!0},{key:"content",fn:function(){return t._l(t.articleDetails.replies,(function(e,i){return n("div",{key:e.id,staticClass:"replies"},[n("div",{staticClass:"author"},[n("div",{staticClass:"show"},[n("router-link",{attrs:{to:{name:"UserDetails",params:{loginname:e.author.loginname}}}},[n("el-avatar",{attrs:{shape:"square",src:e.author.avatar_url}})],1),n("div",{staticClass:"authorName"},[t._v(t._s(e.author.loginname))]),n("span",[t._v(t._s(i+1)+"楼·"+t._s(t._f("fromatDataFromNow")(e.create_at)))])],1),n("div",{staticClass:"operation"},[n("span",{class:{likeActive:e.is_uped,like:!0},on:{click:function(n){return t.changeUped(i,e.id)}}},[t._v(t._s(e.ups.length?e.ups.length:""))]),n("span",{staticClass:"comment",on:{click:function(n){return t.showText(e.id,e.author.loginname)}}})])]),n("div",{staticClass:"content",domProps:{innerHTML:t._s(e.content)}}),n("div",{staticClass:"reply"},[t.showReplyId===e.id?n("div",{ref:"replyText",refInFor:!0,staticClass:"text"},[n("Editor",{attrs:{"output-format":"text","api-key":"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754",init:{elementpath:!1,branding:!1,height:250,menubar:!0,language:"zh_CN",plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"code undo redo restoredraft | cut copy paste pastetext | forecolor backcolor bold italic underline strikethrough link anchor | alignleft aligncenter alignright alignjustify outdent indent |   styleselect formatselect fontselect fontsizeselect | bullist numlist | blockquote subscript superscript removeformat |   table image media charmap emoticons hr pagebreak insertdatetime print preview | fullscreen | bdmap indent2em lineheight formatpainter axupimgs"}},model:{value:t.replayText,callback:function(e){t.replayText=e},expression:"replayText"}}),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.reply(e.reply_id)}}},[t._v("回复")])],1):t._e()]),n("hr")])}))},proxy:!0}],null,!1,65700251)}),n("div",{staticClass:"text"},[n("Editor",{attrs:{"output-format":"text","api-key":"9mieih2cqsubf30b1omff3w107ojvjfvzhmb7haq4giiy754",init:{elementpath:!1,branding:!1,height:250,menubar:!0,language:"zh_CN",plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"code undo redo restoredraft | cut copy paste pastetext | forecolor backcolor bold italic underline strikethrough link anchor | alignleft aligncenter alignright alignjustify outdent indent |   styleselect formatselect fontselect fontsizeselect | bullist numlist | blockquote subscript superscript removeformat |   table image media charmap emoticons hr pagebreak insertdatetime print preview | fullscreen | bdmap indent2em lineheight formatpainter axupimgs"}},model:{value:t.commentText,callback:function(e){t.commentText=e},expression:"commentText"}}),n("el-button",{attrs:{type:"primary"},on:{click:t.comment}},[t._v("回复")])],1)],1)]),n("div",{staticClass:"author"},[n("panel",{scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"title"},[n("h2",[t._v("作者")])])]},proxy:!0},{key:"content",fn:function(){return[n("div",{staticClass:"authorData"},[n("div",{staticClass:"box"},[n("router-link",{attrs:{to:{name:"UserDetails",params:{loginname:t.articleDetails.author.loginname}}}},[n("el-avatar",{attrs:{shape:"square",src:t.author.avatar_url}})],1),n("span",{staticClass:"authorName"},[t._v(t._s(t.author.loginname))])],1)])]},proxy:!0}],null,!1,886733965)})],1)]):t._e()},o=[],r=n("1da1"),a=(n("96cf"),n("99af"),n("4de4"),n("11e2")),s=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],c=function(t){return-1!==s.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},l=function(t,e,n){Object.keys(e).filter(c).forEach((function(i){var o=e[i];"function"===typeof o&&("onInit"===i?o(t,n):n.on(i.substring(2),(function(t){return o(t,n)})))}))},u=function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,i=Array.isArray(n)?n.join(" "):n;e.on(i||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))},p=function(t,e,n){var i=e.$props.value?e.$props.value:"",o=e.$props.initialValue?e.$props.initialValue:"";n.setContent(i||(e.initialized?e.cache:o)),e.$watch("value",(function(t,i){n&&"string"===typeof t&&t!==i&&t!==n.getContent({format:e.$props.outputFormat})&&n.setContent(t)})),e.$listeners.input&&u(e,n),l(t,e.$listeners,n),e.initialized=!0},d=0,h=function(t){var e=Date.now(),n=Math.floor(1e9*Math.random());return d++,t+"_"+n+d+String(e)},f=function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()},m=function(t){return"undefined"===typeof t||""===t?[]:Array.isArray(t)?t:t.split(" ")},g=function(t,e){return m(t).concat(m(e))},v=function(t){return null===t||void 0===t},y=function(){return{listeners:[],scriptId:h("tiny-script"),scriptLoaded:!1}},b=function(){var t=y(),e=function(t,e,n,i){var o=e.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=t,o.src=n;var r=function(){o.removeEventListener("load",r),i()};o.addEventListener("load",r),e.head&&e.head.appendChild(o)},n=function(n,i,o){t.scriptLoaded?o():(t.listeners.push(o),n.getElementById(t.scriptId)||e(t.scriptId,n,i,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},i=function(){t=y()};return{load:n,reinitialize:i}},_=b(),x=n("c4a9"),k={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},C=function(){return C=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},C.apply(this,arguments)},D=function(t,e,n){return t(n||"div",{attrs:{id:e}})},S=function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},w=function(t){return function(){var e=C(C({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:g(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return p(n,t,e)})),t.$props.init&&"function"===typeof t.$props.init.setup&&t.$props.init.setup(e)}});f(t.element)&&(t.element.style.visibility="",t.element.style.display=""),Object(x["a"])().init(e)}},$={props:k,created:function(){this.elementId=this.$props.id||h("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==Object(x["a"])())w(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=v(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;_.load(this.element.ownerDocument,n,w(this))}},beforeDestroy:function(){null!==Object(x["a"])()&&Object(x["a"])().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=Object(x["a"])())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&w(this)()},render:function(t){return this.inlineEditor?D(t,this.elementId,this.$props.tagName):S(t,this.elementId)}},I=$,O=n("c1df"),j=n.n(O),T={components:{panel:a["a"],Editor:I},data:function(){return{articleDetails:null,author:null,commentText:"",showReplyId:0,replayText:""}},created:function(){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$axios.get("/topic/".concat(t.$route.params.topicId,"?accesstoken=").concat(sessionStorage.getItem("token"))).then((function(e){t.articleDetails=e.data,t.author=e.data.author}));case 2:case"end":return e.stop()}}),e)})))()},methods:{showText:function(t,e){this.showReplyId=t,this.replayText="@".concat(e),this.$nextTick((function(){this.$refs.replyText[0].focus()}))},changecollect:function(t){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.articleDetails.is_collect=!e.articleDetails.is_collect,!e.articleDetails.is_collect){n.next=6;break}return n.next=4,e.$axios.post("/topic_collect/collect",{accesstoken:sessionStorage.getItem("token"),topic_id:t});case 4:n.next=8;break;case 6:return n.next=8,e.$axios.post("/topic_collect/de_collect",{accesstoken:sessionStorage.getItem("token"),topic_id:t});case 8:case"end":return n.stop()}}),n)})))()},changeUped:function(t,e){var n=this;return Object(r["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n.articleDetails.replies[t].is_uped=!n.articleDetails.replies[t].is_uped,n.articleDetails.replies[t].is_uped?n.articleDetails.replies[t].ups.push(sessionStorage.getItem("token")):n.articleDetails.replies[t].ups=n.articleDetails.replies[t].ups.filter((function(t){return t!==sessionStorage.getItem("token")})),i.next=4,n.$axios.post("/reply/".concat(e,"/ups"),{accesstoken:sessionStorage.getItem("token")});case 4:case"end":return i.stop()}}),i)})))()},comment:function(){var t={author:{avatar_url:JSON.parse(sessionStorage.getItem("userData")).avatar_url,loginname:JSON.parse(sessionStorage.getItem("userData")).loginname},content:this.commentText,create_at:j()().format(),id:JSON.parse(sessionStorage.getItem("userData")).id,is_uped:!1,reply_id:null,ups:[]};this.$axios.post("/topic/".concat(this.articleDetails.id,"/replies"),{accesstoken:sessionStorage.getItem("token"),content:this.commentText}),this.articleDetails.replies.push(t),this.commentText=""},reply:function(t){var e={author:{avatar_url:JSON.parse(sessionStorage.getItem("userData")).avatar_url,loginname:JSON.parse(sessionStorage.getItem("userData")).loginname},content:this.replayText,create_at:j()().format(),id:JSON.parse(sessionStorage.getItem("userData")).id,is_uped:!1,reply_id:t,ups:[]};console.log(this.replayText),this.$axios.post("/topic/".concat(this.articleDetails.id,"/replies"),{accesstoken:sessionStorage.getItem("token"),content:this.replayText,reply_id:t}),this.articleDetails.replies.push(e),this.showReplyId=0,this.replayText=""}}},E=T,R=(n("65cc"),n("2ebe"),n("2877")),N=Object(R["a"])(E,i,o,!1,null,"9ea1642a",null);e["default"]=N.exports},"65cc":function(t,e,n){"use strict";n("6db5")},"6db5":function(t,e,n){},"82aa":function(t,e,n){},8418:function(t,e,n){"use strict";var i=n("c04e"),o=n("9bf2"),r=n("5c6c");t.exports=function(t,e,n){var a=i(e);a in t?o.f(t,a,r(0,n)):t[a]=n}},"99af":function(t,e,n){"use strict";var i=n("23e7"),o=n("d039"),r=n("e8b5"),a=n("861d"),s=n("7b0b"),c=n("50c4"),l=n("8418"),u=n("65f0"),p=n("1dde"),d=n("b622"),h=n("2d00"),f=d("isConcatSpreadable"),m=9007199254740991,g="Maximum allowed index exceeded",v=h>=51||!o((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),y=p("concat"),b=function(t){if(!a(t))return!1;var e=t[f];return void 0!==e?!!e:r(t)},_=!v||!y;i({target:"Array",proto:!0,forced:_},{concat:function(t){var e,n,i,o,r,a=s(this),p=u(a,0),d=0;for(e=-1,i=arguments.length;e<i;e++)if(r=-1===e?a:arguments[e],b(r)){if(o=c(r.length),d+o>m)throw TypeError(g);for(n=0;n<o;n++,d++)n in r&&l(p,d,r[n])}else{if(d>=m)throw TypeError(g);l(p,d++,r)}return p.length=d,p}})},c4a9:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return o}));var i=function(){return"undefined"!==typeof window?window:t},o=function(){var t=i();return t&&t.tinymce?t.tinymce:null}}).call(this,n("c8ba"))}}]);
//# sourceMappingURL=chunk-04ad57c3.254713fd.js.map